
<!DOCTYPE html>
<html lang="en" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ù…Ø§Ø² Ú©Ø§ Ø±ÛŒÚ©Ø§Ø±Úˆ</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> <!-- SweetAlert Library -->
    <link rel="stylesheet" href="./styles.css">
   
</head>
<body>
    <div class="container">
        <div class="navbar">
            <h2>Ù†Ù…Ø§Ø² Ú©Ø§ Ø±ÛŒÚ©Ø§Ø±Úˆ - <span id="month-year"></span></h2>
            
            <a class="btn-1" href="./islamic.html">
                ğŸ“œ Ø§Ø³Ù„Ø§Ù…ÛŒ Ø³ÙˆØ§Ù„Ù†Ø§Ù…Û
            </a>
        </div>
    </div>
    
    <table class="table table-bordered table-striped text-center">
        <thead class="">
            <tr>
                <th>ØªØ§Ø±ÛŒØ®</th>
                <th>ÙØ¬Ø±</th>
                <th>Ø¸ÛØ±</th>
                <th>Ø¹ØµØ±</th>
                <th>Ù…ØºØ±Ø¨</th>
                <th>Ø¹Ø´Ø§Ø¡</th>
            </tr>
        </thead>
        <tbody id="namaz-table"></tbody>
    </table>
    <div class="button-container">

        
        
        <button class="btn reset-btn" id="logout-btn">ğŸšª Ù„Ø§Ú¯ Ø¢Ø¤Ù¹ Ú©Ø±ÛŒÚº </button>
        <button class="btn reset-btn" onclick="confirmReset()">ğŸ”„ Ø±ÛŒ Ø³ÛŒÙ¹ Ú©Ø±ÛŒÚº</button>
        <button class="btn csv-btn" onclick="downloadCSV()">ğŸ“¥ Download CSV</button> 
    </div>


   
   


    <script type="">
        let today = new Date();
        let currentMonth = today.getMonth();
        let currentYear = today.getFullYear();
        let monthNames = ["Ø¬Ù†ÙˆØ±ÛŒ", "ÙØ±ÙˆØ±ÛŒ", "Ù…Ø§Ø±Ú†", "Ø§Ù¾Ø±ÛŒÙ„", "Ù…Ø¦ÛŒ", "Ø¬ÙˆÙ†", "Ø¬ÙˆÙ„Ø§Ø¦ÛŒ", "Ø§Ú¯Ø³Øª", "Ø³ØªÙ…Ø¨Ø±", "Ø§Ú©ØªÙˆØ¨Ø±", "Ù†ÙˆÙ…Ø¨Ø±", "Ø¯Ø³Ù…Ø¨Ø±"];
        document.getElementById("month-year").innerText = `${monthNames[currentMonth]} ${currentYear}`;

        let daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
        let tableBody = document.getElementById("namaz-table");

        function loadTracker() {
            let savedData = JSON.parse(localStorage.getItem("namazTracker")) || {};
            tableBody.innerHTML = ""; 
            for (let i = 1; i <= daysInMonth; i++) {
                let formattedDate = `${String(i).padStart(2, '0')}-${String(currentMonth + 1).padStart(2, '0')}-${currentYear}`;
                let row = `<tr>
                    <td><strong>${formattedDate}</strong></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Fajr" ${savedData[formattedDate]?.Fajr ? "checked" : ""}></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Dhuhr" ${savedData[formattedDate]?.Dhuhr ? "checked" : ""}></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Asr" ${savedData[formattedDate]?.Asr ? "checked" : ""}></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Maghrib" ${savedData[formattedDate]?.Maghrib ? "checked" : ""}></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Isha" ${savedData[formattedDate]?.Isha ? "checked" : ""}></td>
                </tr>`;
                tableBody.innerHTML += row;
            }
            document.querySelectorAll("input[type='checkbox']").forEach(checkbox => {
                checkbox.addEventListener("change", saveTracker);
            });
        }

        function saveTracker() {
            let trackerData = {};
            document.querySelectorAll("input[type='checkbox']").forEach(checkbox => {
                let date = checkbox.getAttribute("data-date");
                let namaz = checkbox.getAttribute("data-namaz");
                if (!trackerData[date]) {
                    trackerData[date] = {};
                }
                trackerData[date][namaz] = checkbox.checked;
            });
            localStorage.setItem("namazTracker", JSON.stringify(trackerData));
        }

        function confirmReset() {
            Swal.fire({
                title: "Ú©ÛŒØ§ Ø¢Ù¾ ÙˆØ§Ù‚Ø¹ÛŒ Ø±ÛŒ Ø³ÛŒÙ¹ Ú©Ø±Ù†Ø§ Ú†Ø§ÛØªÛ’ ÛÛŒÚºØŸ",
                text: "ØªÙ…Ø§Ù… ÚˆÛŒÙ¹Ø§ Ø®ØªÙ… ÛÙˆØ¬Ø§Ø¦Û’ Ú¯Ø§!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#d33",
                cancelButtonColor: "#3085d6",
                confirmButtonText: "Ø¬ÛŒ ÛØ§ÚºØŒ Ø±ÛŒ Ø³ÛŒÙ¹ Ú©Ø±ÛŒÚº",
                cancelButtonText: "Ù…Ù†Ø³ÙˆØ® Ú©Ø±ÛŒÚº"
            }).then((result) => {
                if (result.isConfirmed) {
                    resetTracker();
                }
            });
        }

        function resetTracker() {
            localStorage.removeItem("namazTracker");
            loadTracker();
            Swal.fire("Ø±ÛŒ Ø³ÛŒÙ¹ ÛÙˆÚ¯ÛŒØ§!", "Ø¢Ù¾ Ú©Ø§ ÚˆÛŒÙ¹Ø§ Ø®ØªÙ… Ú©Ø±Ø¯ÛŒØ§ Ú¯ÛŒØ§Û”", "success");
        }

        function getTableData() {
            let data = [
                ["ØªØ§Ø±ÛŒØ®", "ÙØ¬Ø±", "Ø¸ÛØ±", "Ø¹ØµØ±", "Ù…ØºØ±Ø¨", "Ø¹Ø´Ø§Ø¡"]
            ];
            document.querySelectorAll("tbody tr").forEach(row => {
                let rowData = [row.children[0].innerText];
                for (let i = 1; i <= 5; i++) {
                    let checkbox = row.children[i].querySelector("input[type='checkbox']");
                    rowData.push(checkbox.checked ? "âœ”" : "âœ–");
                }
                data.push(rowData);
            });
            return data;
        }

        function downloadCSV() {
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
            let data = getTableData();

            data.forEach(row => {
                csvContent += row.join(",") + "\n";
            });

            let encodedUri = encodeURI(csvContent);
            let link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "namaz_record.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        document.addEventListener("DOMContentLoaded", loadTracker);
    </script> 
    <!-- <script src="attendance.js" type="module"></script> -->
</body>
</html>
