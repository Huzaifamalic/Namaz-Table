
<!DOCTYPE html>
<html lang="ur" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نماز کا ریکارڈ</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Nastaliq+Urdu&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script> <!-- SweetAlert Library -->

    <style>
        body {
    font-family: 'Noto Nastaliq Urdu', Arial, sans-serif;
    background-color: #f8f9fa;
    text-align: center;
    margin: 20px;
    direction: rtl;
    padding: 10px;
    box-sizing: border-box;
}

.container {
    max-width: 900px;
    width: 100%;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    margin: auto;
}

/* ✅ Responsive Navbar */
.navbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px 20px;
    background-color: #343a40;
    color: white;
    border-radius: 8px;
    flex-wrap: wrap;
}

/* ✅ Responsive Buttons */
.btn {
    margin-top: 20px;
    padding: 12px 18px;
    color: white;
    border: none;
    cursor: pointer;
    border-radius: 5px;
    transition: 0.3s;
    font-size: 16px;
}

.reset-btn {
    background-color: #dc3545;
}

.download-btn {
    background-color: #28a745;
}

.csv-btn {
    background-color: #007bff;
}

/* ✅ Table Styling */
table {
    width: 100%;
    margin-top: 20px;
    border-collapse: collapse;
}

th, td {
    padding: 10px;
    border: 1px solid #ddd;
    text-align: center;
}

/* ✅ Checkbox Scaling */
input[type="checkbox"] {
    transform: scale(1.3);
    cursor: pointer;
}

/* ✅ Mobile Screens (Small Devices) */
@media (max-width: 480px) {
    .container {
        padding: 15px;
        max-width: 100%;
    }

    .navbar {
        flex-direction: column;
        text-align: center;
        padding: 15px;
    }

    .btn {
        width: 100%;
        padding: 10px;
        font-size: 14px;
    }

    th, td {
        font-size: 14px;
        padding: 8px;
    }
}

/* ✅ Tablets (Medium Devices) */
@media (max-width: 768px) {
    .container {
        padding: 18px;
        max-width: 95%;
    }

    .btn {
        padding: 12px;
        font-size: 15px;
    }

    table {
        font-size: 15px;
    }
}

    </style>
</head>
<body>
    <div class="container">
        <div class="navbar">
            <h2>نماز کا ریکارڈ - <span id="month-year"></span></h2>
            
            <a class="btn btn-warning text-dark fw-bold" href="./islamic.html">
                📜 اسلامی سوالنامہ
            </a>
        </div>
    </div>
    
    <table class="table table-bordered table-striped text-center">
        <thead class="table-dark">
            <tr>
                <th>تاریخ</th>
                <th>فجر</th>
                <th>ظہر</th>
                <th>عصر</th>
                <th>مغرب</th>
                <th>عشاء</th>
            </tr>
        </thead>
        <tbody id="namaz-table"></tbody>
    </table>
    
    
    <button class="btn reset-btn" id="logout-btn">🚪 لاگ آؤٹ کریں </button>
    <button class="btn reset-btn" onclick="confirmReset()">🔄 ری سیٹ کریں</button>
    <button class="btn csv-btn" onclick="downloadCSV()">📥 Download CSV</button>

    <script type="">

        


        let today = new Date();
        let currentMonth = today.getMonth();
        let currentYear = today.getFullYear();
        let monthNames = ["جنوری", "فروری", "مارچ", "اپریل", "مئی", "جون", "جولائی", "اگست", "ستمبر", "اکتوبر", "نومبر", "دسمبر"];
        document.getElementById("month-year").innerText = `${monthNames[currentMonth]} ${currentYear}`;

        let daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
        let tableBody = document.getElementById("namaz-table");

        function loadTracker() {
            let savedData = JSON.parse(localStorage.getItem("namazTracker")) || {};
            tableBody.innerHTML = ""; 
            for (let i = 1; i <= daysInMonth; i++) {
                let formattedDate = `${String(i).padStart(2, '0')}-${String(currentMonth + 1).padStart(2, '0')}-${currentYear}`;
                let row = `<tr>
                    <td><strong>${formattedDate}</strong></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Fajr" ${savedData[formattedDate]?.Fajr ? "checked" : ""}></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Dhuhr" ${savedData[formattedDate]?.Dhuhr ? "checked" : ""}></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Asr" ${savedData[formattedDate]?.Asr ? "checked" : ""}></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Maghrib" ${savedData[formattedDate]?.Maghrib ? "checked" : ""}></td>
                    <td><input type="checkbox" data-date="${formattedDate}" data-namaz="Isha" ${savedData[formattedDate]?.Isha ? "checked" : ""}></td>
                </tr>`;
                tableBody.innerHTML += row;
            }
            document.querySelectorAll("input[type='checkbox']").forEach(checkbox => {
                checkbox.addEventListener("change", saveTracker);
            });
        }

        function saveTracker() {
            let trackerData = {};
            document.querySelectorAll("input[type='checkbox']").forEach(checkbox => {
                let date = checkbox.getAttribute("data-date");
                let namaz = checkbox.getAttribute("data-namaz");
                if (!trackerData[date]) {
                    trackerData[date] = {};
                }
                trackerData[date][namaz] = checkbox.checked;
            });
            localStorage.setItem("namazTracker", JSON.stringify(trackerData));
        }

        function confirmReset() {
            Swal.fire({
                title: "کیا آپ واقعی ری سیٹ کرنا چاہتے ہیں؟",
                text: "تمام ڈیٹا ختم ہوجائے گا!",
                icon: "warning",
                showCancelButton: true,
                confirmButtonColor: "#d33",
                cancelButtonColor: "#3085d6",
                confirmButtonText: "جی ہاں، ری سیٹ کریں",
                cancelButtonText: "منسوخ کریں"
            }).then((result) => {
                if (result.isConfirmed) {
                    resetTracker();
                }
            });
        }

        function resetTracker() {
            localStorage.removeItem("namazTracker");
            loadTracker();
            Swal.fire("ری سیٹ ہوگیا!", "آپ کا ڈیٹا ختم کردیا گیا۔", "success");
        }

        function getTableData() {
            let data = [
                ["تاریخ", "فجر", "ظہر", "عصر", "مغرب", "عشاء"]
            ];
            document.querySelectorAll("tbody tr").forEach(row => {
                let rowData = [row.children[0].innerText];
                for (let i = 1; i <= 5; i++) {
                    let checkbox = row.children[i].querySelector("input[type='checkbox']");
                    rowData.push(checkbox.checked ? "✔" : "✖");
                }
                data.push(rowData);
            });
            return data;
        }

        function downloadCSV() {
            let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
            let data = getTableData();

            data.forEach(row => {
                csvContent += row.join(",") + "\n";
            });

            let encodedUri = encodeURI(csvContent);
            let link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", "namaz_record.csv");
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        document.addEventListener("DOMContentLoaded", loadTracker);
    </script>
    <script src="attendance.js" type="module"></script>
</body>
</html>
